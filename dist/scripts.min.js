let pokemonRepository = (function () {
  let e = [];
  function t(e) {
    return e.charAt(0).toUpperCase() + e.slice(1);
  }
  function n(n) {
    "object" == typeof n && "name" in n
      ? ((n.name = t(n.name)), e.push(n))
      : console.error("Invalid Pok\xe9mon name");
  }
  function o(e) {
    let t = document.querySelector(".pokemon-list"),
      n = document.createElement("li");
    n.classList.add("list-group-item");
    let o = document.createElement("button");
    (o.type = "button"),
      (o.innerHTML = e.name),
      o.classList.add("btn"),
      o.setAttribute("data-bs-toggle", "modal"),
      o.setAttribute("data-bs-target", "#pokemonModal"),
      o.addEventListener("click", function () {
        i(e);
      }),
      n.appendChild(o),
      t.appendChild(n);
  }
  function i(e) {
    var t;
    ((t = e),
    a(),
    fetch(t.detailsUrl)
      .then(function (e) {
        return e.json();
      })
      .then(function (e) {
        (t.imageUrl = e.sprites.front_default),
          (t.height = e.height),
          (t.weight = e.weight),
          (t.types = e.types),
          l();
      })
      .catch(function (e) {
        console.error("Failed to load Pok\xe9mon details:", e), l();
      })).then(function () {
      r(e);
    });
  }
  function a() {
    document.querySelector(".loading-message").innerText = "Loading...";
  }
  function l() {
    document.querySelector(".loading-message").innerText = "";
  }
  function r(e) {
    var n, o, i;
    let a = document.querySelector(".modal-image"),
      l = document.querySelector(".modal-title"),
      r = document.querySelector(".modal-height"),
      s = document.querySelector(".modal-weight"),
      c = document.querySelector(".modal-types");
    (a.src = e.imageUrl),
      (a.alt = `Image of ${e.name}`),
      (l.innerText = e.name),
      (r.innerHTML = `Height: <span class="bold">${
        parseInt((n = e.height), 10) / 10
      } m</span>`),
      (s.innerHTML = `Weight: <span class="bold">${
        parseInt((o = e.weight), 10) / 10
      } kg</span>`),
      (c.innerHTML = `Types: <span class="bold">${(i = e.types)
        .map((e) => t(e.type.name))
        .join(", ")}</span>`);
    let d = document.getElementById("pokemonModal");
    d.classList.add("show");
  }
  function s() {
    return e;
  }
  function c(t) {
    d(e.filter((e) => e.name.toLowerCase().includes(t.toLowerCase())));
  }
  function d(e) {
    (document.querySelector(".pokemon-list").innerHTML = ""),
      e.forEach((e) => o(e));
  }
  document
    .querySelector("#pokemon-search")
    .addEventListener("input", function (e) {
      c(e.target.value);
    });
  let u = document.getElementById("btn-back-to-top");
  return (
    window.addEventListener("scroll", function () {
      window.scrollY > 300
        ? (u.style.display = "block")
        : (u.style.display = "none");
    }),
    u.addEventListener("click", function () {
      window.scrollTo({ top: 0, behavior: "smooth" });
    }),
    {
      getAll: s,
      add: n,
      addListItem: o,
      loadList: function e() {
        return (
          a(),
          fetch("https://pokeapi.co/api/v2/pokemon/?limit=150")
            .then(function (e) {
              return e.json();
            })
            .then(function (e) {
              e.results.forEach(function (e) {
                n({ name: e.name, detailsUrl: e.url });
              }),
                l();
            })
            .catch(function (e) {
              console.error("Failed to load Pok\xe9mon list:", e), l();
            })
        );
      },
      showDetails: i,
      showModal: r,
      renderList: d,
      searchPokemon: c,
    }
  );
})();
pokemonRepository.loadList().then(function () {
  pokemonRepository.getAll().forEach(function (e) {
    pokemonRepository.addListItem(e);
  });
});
